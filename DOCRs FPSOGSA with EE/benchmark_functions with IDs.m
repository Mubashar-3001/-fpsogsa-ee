%FPSOGSA with EE source code v3.0, Generated by Engr. mubashar javed, 2024. 
%Adopted from: S. Mirjalili, S.Z. Mohd Hashim, “A New Hybrid PSOGSA 
%Algorithm for Function Optimization.
% This function calculates the value of objective function.
function fit=benchmark_functions(L,Benchmark_Function_ID,dim)
%You can insert your own objective function with a new Benchmark_Function_ID.

if Benchmark_Function_ID==1
fit=sum(L.^2);
end

if Benchmark_Function_ID==2 
fit=sum(abs(L))+prod(abs(L));
end

if Benchmark_Function_ID==3
    fit=0;
    for i=1:dim
    fit=fit+sum(L(1:i))^2;
    end
end

if Benchmark_Function_ID==4
    fit=max(abs(L));
end

if Benchmark_Function_ID==5
    fit=sum(100*(L(2:dim)-(L(1:dim-1).^2)).^2+(L(1:dim-1)-1).^2);
end

if Benchmark_Function_ID==6
    fit=sum(abs((L+.5)).^2);
end

if Benchmark_Function_ID==7
    fit=sum([1:dim].*(L.^4))+rand;
end

if Benchmark_Function_ID==8
    fit=sum(-L.*sin(sqrt(abs(L))));
end

if Benchmark_Function_ID==9
    fit=sum(L.^2-10*cos(2*pi.*L))+10*dim;
end

if Benchmark_Function_ID==10
    fit=-20*exp(-.2*sqrt(sum(L.^2)/dim))-exp(sum(cos(2*pi.*L))/dim)+20+exp(1);
end

if Benchmark_Function_ID==11
    fit=sum(L.^2)/4000-prod(cos(L./sqrt([1:dim])))+1;
end

if Benchmark_Function_ID==12
    fit=(pi/dim)*(10*((sin(pi*(1+(L(1)+1)/4)))^2)+sum((((L(1:dim-1)+1)./4).^2).*...
        (1+10.*((sin(pi.*(1+(L(2:dim)+1)./4)))).^2))+((L(dim)+1)/4)^2)+sum(Ufun(L,10,100,4));
end
if Benchmark_Function_ID==13
    fit=.1*((sin(3*pi*L(1)))^2+sum((L(1:dim-1)-1).^2.*(1+(sin(3.*pi.*L(2:dim))).^2))+...
        ((L(dim)-1)^2)*(1+(sin(2*pi*L(dim)))^2))+sum(Ufun(L,5,100,4));
end

if Benchmark_Function_ID==14
aS=[-32 -16 0 16 32 -32 -16 0 16 32 -32 -16 0 16 32 -32 -16 0 16 32 -32 -16 0 16 32;,...
-32 -32 -32 -32 -32 -16 -16 -16 -16 -16 0 0 0 0 0 16 16 16 16 16 32 32 32 32 32];
    for j=1:25
        bS(j)=sum((L'-aS(:,j)).^6);
    end
    fit=(1/500+sum(1./([1:25]+bS))).^(-1);
end

if Benchmark_Function_ID==15
    aK=[.1957 .1947 .1735 .16 .0844 .0627 .0456 .0342 .0323 .0235 .0246];
    bK=[.25 .5 1 2 4 6 8 10 12 14 16];bK=1./bK;
    fit=sum((aK-((L(1).*(bK.^2+L(2).*bK))./(bK.^2+L(3).*bK+L(4)))).^2);
end

if Benchmark_Function_ID==16
    fit=4*(L(1)^2)-2.1*(L(1)^4)+(L(1)^6)/3+L(1)*L(2)-4*(L(2)^2)+4*(L(2)^4);
end

if Benchmark_Function_ID==17
    fit=(L(2)-(L(1)^2)*5.1/(4*(pi^2))+5/pi*L(1)-6)^2+10*(1-1/(8*pi))*cos(L(1))+10;
end

if Benchmark_Function_ID==18
    fit=(1+(L(1)+L(2)+1)^2*(19-14*L(1)+3*(L(1)^2)-14*L(2)+6*L(1)*L(2)+3*L(2)^2))*...
        (30+(2*L(1)-3*L(2))^2*(18-32*L(1)+12*(L(1)^2)+48*L(2)-36*L(1)*L(2)+27*(L(2)^2)));
end

if Benchmark_Function_ID==19
    aH=[3 10 30;.1 10 35;3 10 30;.1 10 35];cH=[1 1.2 3 3.2];
    pH=[.3689 .117 .2673;.4699 .4387 .747;.1091 .8732 .5547;.03815 .5743 .8828];
    fit=0;
    for i=1:4
    fit=fit-cH(i)*exp(-(sum(aH(i,:).*((L-pH(i,:)).^2))));
    end
end

if Benchmark_Function_ID==20
    aH=[10 3 17 3.5 1.7 8;.05 10 17 .1 8 14;3 3.5 1.7 10 17 8;17 8 .05 10 .1 14];
cH=[1 1.2 3 3.2];
pH=[.1312 .1696 .5569 .0124 .8283 .5886;.2329 .4135 .8307 .3736 .1004 .9991;...
.2348 .1415 .3522 .2883 .3047 .6650;.4047 .8828 .8732 .5743 .1091 .0381];
    fit=0;
    for i=1:4
    fit=fit-cH(i)*exp(-(sum(aH(i,:).*((L-pH(i,:)).^2))));
    end
end
% aSH=[4 4 4 4;1 1 1 1;8 8 8 8;6 6 6 6;3 7 3 7;2 9 2 9;5 5 3 3;8 1 8 1;6 2 6 2;7 3.6 7 3.6];
% cSH=[.1 .2 .2 .4 .4 .6 .3 .7 .5 .5];

%%%% The Values Given For TMS (Time Multiplier Setting)
%% Calculation For IEEE 15 Bus System
if Benchmark_Function_ID==21
TMS1=L(1,1);
TMS2=L(1,2);
TMS3=L(1,3);
TMS4=L(1,4);
TMS5=L(1,5);
TMS6=L(1,6);
TMS7=L(1,7);
TMS8=L(1,8);
TMS9=L(1,9);
TMS10=L(1,10);
TMS11=L(1,11);
TMS12=L(1,12);
TMS13=L(1,13);
TMS14=L(1,14);
TMS15=L(1,15);
TMS16=L(1,16);
TMS17=L(1,17);
TMS18=L(1,18);
TMS19=L(1,19);
TMS20=L(1,20);
TMS21=L(1,21);
TMS22=L(1,22);
TMS23=L(1,23);
TMS24=L(1,24);
TMS25=L(1,25);
TMS26=L(1,26);
TMS27=L(1,27);
TMS28=L(1,28);
TMS29=L(1,29);
TMS30=L(1,30);
TMS31=L(1,31);
TMS32=L(1,32);
TMS33=L(1,33);
TMS34=L(1,34);
TMS35=L(1,35);
TMS36=L(1,36);
TMS37=L(1,37);
TMS38=L(1,38);
TMS39=L(1,39);
TMS40=L(1,40);
TMS41=L(1,41);
TMS42=L(1,42);
%% The Values Given For PTS (Pickup Tap setting) 
PTS1=L(1,43);
PTS2=L(1,44);
PTS3=L(1,45);
PTS4=L(1,46);
PTS5=L(1,47);
PTS6=L(1,48);
PTS7=L(1,49);
PTS8=L(1,50);
PTS9=L(1,51);
PTS10=L(1,52);
PTS11=L(1,53);
PTS12=L(1,54);
PTS13=L(1,55);
PTS14=L(1,56);
PTS15=L(1,57);
PTS16=L(1,58);
PTS17=L(1,59);
PTS18=L(1,60);
PTS19=L(1,61);
PTS20=L(1,62);
PTS21=L(1,63);
PTS22=L(1,64);
PTS23=L(1,65);
PTS24=L(1,66);
PTS25=L(1,67);
PTS26=L(1,68);
PTS27=L(1,69);
PTS28=L(1,70);
PTS29=L(1,71);
PTS30=L(1,72);
PTS31=L(1,73);
PTS32=L(1,74);
PTS33=L(1,75);
PTS34=L(1,76);
PTS35=L(1,77);
PTS36=L(1,78);
PTS37=L(1,79);
PTS38=L(1,80);
PTS39=L(1,81);
PTS40=L(1,82);
PTS41=L(1,83);
PTS42=L(1,84);
u=1;
v=14;
u1=1;
u2=1;
v1=14;
v2=14;
x=[TMS1,TMS2,TMS3,TMS4,TMS5,TMS6,TMS7,TMS8,TMS9,TMS10,TMS11,TMS12,TMS13,TMS14];
y=[PTS1,PTS2,PTS3,PTS4,PTS5,PTS6,PTS7,PTS8,PTS9,PTS10,PTS11,PTS12,PTS13,PTS14];
x1=[TMS15,TMS16,TMS17,TMS18,TMS19,TMS20,TMS21,TMS22,TMS23,TMS24,TMS25,TMS26,TMS27,TMS28];
y1=[PTS15,PTS16,PTS17,PTS18,PTS19,PTS20,PTS21,PTS22,PTS23,PTS24,PTS25,PTS26,PTS27,PTS28];
x2=[TMS29,TMS30,TMS31,TMS32,TMS33,TMS34,TMS35,TMS36,TMS37,TMS38,TMS39,TMS40,TMS41,TMS42];
y2=[PTS29,PTS30,PTS31,PTS32,PTS33,PTS34,PTS35,PTS36,PTS37,PTS38,PTS39,PTS40,PTS41,PTS42];
TMS_1=x;
PTS_1=y;
TMS_2=x1;
PTS_2=y1;
TMS_3=x2;
PTS_3=y2;

%% Fault Current For Primary Relay Values
FaultCurrent_P=[3621,4597,3984,4382,3319,2647,2497,4695,2943,3568,4342,4195,3402,4606];  % Fault Current For Primary Relay Values
FaultCurrent1_P=[4712,2225,1875,8426,3998,7662,8384,1950,4910,2296,2289,2300,2011,2525]; % Fault Current For Primary Relay Values
FaultCurrent2_P=[8346,1736,2867,2069,2305,1715,2095,3283,3301,1403,1434,3140,1971,3295]; % Fault Current For Primary Relay Values
%% Fault Current For Backup Relay Values
FaultCurrent_B=[853,922,1424,1477,1397,1233,1111,1548,1009,1100,1475,1463,1503,1175];  
FaultCurrent1_B=[969,743,599,1320,1372,1808,175,642,979,753,903,905,1039,1192]; 
FaultCurrent2_B=[1828,681,809,697,1162,970,910,1109,1434,882,896,1403,745,907];
%% Current Transformer Ratio Values
CTRatio=[800,1200,800,1200,800,600,600,1200,600,800,1200,1200,800,1200];
CTRatio1=[1200,600,400,1600,800,1600,1600,400,1200,600,600,600,600,600];
CTRatio2=[1600,400,600,600,600,400,600,800,800,400,400,800,400,800];
%% Change CTRatio Matrix Transform
CTRatio_Value=zeros(u,v);  
for i=1:u
    for j=1:v
        CTRatio_Value(i,j)=CTRatio(u,v);
    end
end
CTRatio_Value1=zeros(u1,v1); % Change CTRatio Matrix Transform 
for i1=1:u1
    for j1=1:v1
        CTRatio_Value1(i1,j1)=CTRatio1(u1,v1);
    end
end
CTRatio_Value2=zeros(u2,v2); % Change CTRatio Matrix Transform
for i2=1:u2
    for j2=1:v2
        CTRatio_Value2(i2,j2)=CTRatio2(u2,v2);
    end
end
%% PickupTapSetting Values
PickupTapSetting=((CTRatio/5)).*PTS_1;
PickupTapSetting1=((CTRatio1/5)).*PTS_2;
PickupTapSetting2=((CTRatio2/5)).*PTS_3;
%% PlugSettingMultiplier values for Primary Relay
PlugSettingMultiplier_P=((FaultCurrent_P)).*((PickupTapSetting).^(-1));
PlugSettingMultiplier1_P=((FaultCurrent1_P)).*((PickupTapSetting1).^(-1));
PlugSettingMultiplier2_P=((FaultCurrent2_P)).*((PickupTapSetting2).^(-1));
%% PlugSettingMultiplier values for Backup Relay
PlugSettingMultiplier_B=((FaultCurrent_B)).*((PickupTapSetting).^(-1));
PlugSettingMultiplier1_B=((FaultCurrent1_B)).*((PickupTapSetting1).^(-1));
PlugSettingMultiplier2_B=((FaultCurrent2_B)).*((PickupTapSetting2).^(-1));
%% Calculation of simplified PMS Values 
PSM_Value_P=(((PlugSettingMultiplier_P).^0.02)-1);
PSM_Value1_P=(((PlugSettingMultiplier1_P).^0.02)-1);
PSM_Value2_P=(((PlugSettingMultiplier2_P).^0.02)-1);
PSM_Value_B=(((PlugSettingMultiplier_B).^0.02)-1);
PSM_Value1_B=(((PlugSettingMultiplier1_B).^0.02)-1);
PSM_Value2_B=(((PlugSettingMultiplier2_B).^0.02)-1);
TMS_Value=(0.14*TMS_1);
TMS_Value1=(0.14*TMS_2);
TMS_Value2=(0.14*TMS_3);
%% Calculation of Operating Time of Primary Relay
Top=((TMS_Value).*((PSM_Value_P).^(-1)));
Top_1=((TMS_Value1).*((PSM_Value1_P).^(-1)));
Top_2=((TMS_Value2).*((PSM_Value2_P).^(-1)));
%% Calculation of Operating Time of Backup Relay
Tob=((TMS_Value).*((PSM_Value_B).^(-1)));
Tob_1=((TMS_Value1).*((PSM_Value1_B).^(-1)));
Tob_2=((TMS_Value2).*((PSM_Value2_B).^(-1)));
%% Total Time of Operation for the Primary Relay
Top1=(Top(1,1)+(Top(1,2))+Top(1,3)+Top(1,4)+Top(1,5)+(Top(1,6))+(Top(1,7))+(Top(1,8))+Top(1,9)+Top(1,10)+Top(1,11)+(Top(1,12))+Top(1,13)+((Top(1,14))));
Top2=(Top_1(1,1)+(Top_1(1,2))+Top_1(1,3)+Top_1(1,4)+Top_1(1,5)+(Top_1(1,6))+(Top_1(1,7))+(Top_1(1,8))+Top_1(1,9)+Top_1(1,10)+Top_1(1,11)+(Top_1(1,12))+Top_1(1,13)+((Top_1(1,14))));
Top3=(Top_2(1,1)+(Top_2(1,2))+Top_2(1,3)+Top_2(1,4)+Top_2(1,5)+(Top_2(1,6))+(Top_2(1,7))+(Top_2(1,8))+Top_2(1,9)+Top_2(1,10)+Top_2(1,11)+(Top_2(1,12))+Top_2(1,13)+((Top_2(1,14))));
Top_Primary=Top1+Top2+Top3;
% fprintf('The value of Operating Time Top1=%f \n', Top1);
% fprintf('The value of Operating Time Top2=%f \n', Top2);
% fprintf('The value of Operating Time Top3=%f \n', Top3);
fprintf('The value of Total Operating Time of Primary Relays for fourteen Bus System=%f \n', Top_Primary);
fit=Top_Primary;
%% Coordination of time interval (C.T.I) between the Backup and Primary Relays
CTI_RelayNo_1= Tob(1,6)- Top(1,1);
CTI_RelayNo_2= Tob(1,4)- Top(1,2);
CTI_RelayNo_2a= Tob_1(1,2)- Top(1,2);
CTI_RelayNo_3= Tob(1,1)- Top(1,3);
CTI_RelayNo_3a= Tob_1(1,2)- Top(1,3);
CTI_RelayNo_4= Tob(1,7)- Top(1,4);
CTI_RelayNo_4a= Tob(1,12)- Top(1,4);
CTI_RelayNo_4b= Tob_1(1,6)- Top(1,4);
CTI_RelayNo_5= Tob(1,2)- Top(1,5);
CTI_RelayNo_6= Tob(1,8)- Top(1,6);
CTI_RelayNo_6a= Tob(1,10)- Top(1,6);
CTI_RelayNo_7= Tob(1,5)- Top(1,7);
CTI_RelayNo_7a= Tob(1,10)- Top(1,7);
CTI_RelayNo_8= Tob(1,3)- Top(1,8);
CTI_RelayNo_8a= Tob(1,12)- Top(1,8);
CTI_RelayNo_8b= Tob_1(1,6)- Top(1,8);
CTI_RelayNo_9= Tob(1,5)- Top(1,9);
CTI_RelayNo_9a= Tob(1,8)- Top(1,9);
CTI_RelayNo_10= Tob(1,14)- Top(1,10);
CTI_RelayNo_11= Tob(1,3)- Top(1,11);
CTI_RelayNo_11a= Tob(1,7)- Top(1,11);
CTI_RelayNo_11b= Tob_1(1,6)- Top(1,11);
CTI_RelayNo_12= Tob(1,13)- Top(1,12);
CTI_RelayNo_12a= Tob_1(1,10)- Top(1,12);
CTI_RelayNo_13= Tob(1,9)- Top(1,13);
CTI_RelayNo_14= Tob(1,11)- Top(1,14);
CTI_RelayNo_14a= Tob_1(1,10)- Top(1,14);
CTI_RelayNo_15= Tob(1,1)- Top_1(1,1);
CTI_RelayNo_15a= Tob(1,4)- Top_1(1,1);
CTI_RelayNo_16= Tob_1(1,4)- Top_1(1,2);
CTI_RelayNo_16a= Tob(1,12)- Top_1(1,2);
CTI_RelayNo_17= Tob_1(1,1)- Top_1(1,3);
CTI_RelayNo_17a= Tob_1(1,10)- Top_1(1,3);
CTI_RelayNo_18= Tob_1(1,5)- Top_1(1,4);
CTI_RelayNo_18a= Tob_1(1,8)- Top_1(1,4);
CTI_RelayNo_18b= Tob_2(1,2)- Top_1(1,4);
CTI_RelayNo_19= Tob(1,3)- Top_1(1,5);
CTI_RelayNo_19a= Tob(1,7)- Top_1(1,5);
CTI_RelayNo_19b= Tob(1,12)- Top_1(1,5);
CTI_RelayNo_20= Tob_1(1,3)- Top_1(1,6);
CTI_RelayNo_20a= Tob_1(1,8)- Top_1(1,6);
CTI_RelayNo_20b= Tob_2(1,2)- Top_1(1,6);
CTI_RelayNo_21= Tob_1(1,3)- Top_1(1,7);
CTI_RelayNo_21a= Tob_1(1,5)- Top_1(1,7);
CTI_RelayNo_21b= Tob_2(1,2)- Top_1(1,7);
CTI_RelayNo_22= Tob_1(1,8)- Top_1(1,8);
CTI_RelayNo_22a= Tob_2(1,6)- Top_1(1,8);
CTI_RelayNo_23= Tob(1,11)- Top_1(1,9);
CTI_RelayNo_23a= Tob(1,13)-Top_1(1,9);
CTI_RelayNo_24= Tob_1(1,7)- Top_1(1,10);
CTI_RelayNo_24a= Tob_2(1,6)- Top_1(1,10);
CTI_RelayNo_25= Tob_1(1,1)- Top_1(1,11);
CTI_RelayNo_25a= Tob_1(1,4)- Top_1(1,11);
CTI_RelayNo_26= Tob_1(1,14)- Top_1(1,12);
CTI_RelayNo_26a= Tob_2(1,8)- Top_1(1,12);
CTI_RelayNo_27= Tob_1(1,11)- Top_1(1,13);
CTI_RelayNo_27a= Tob_2(1,8)- Top_1(1,13);
CTI_RelayNo_28= Tob_2(1,1)- Top_1(1,14);
CTI_RelayNo_28a= Tob(1,4)- Top_1(1,14);
CTI_RelayNo_29= Tob_1(1,3)- Top_2(1,1);
CTI_RelayNo_29a= Tob_1(1,5)- Top_2(1,1);
CTI_RelayNo_29b= Tob_1(1,8)- Top_2(1,1);
CTI_RelayNo_30= Tob_1(1,13)- Top_2(1,2);
CTI_RelayNo_30a= Tob_2(1,4)-Top_2(1,2);
CTI_RelayNo_31= Tob_1(1,13)- Top_2(1,3);
CTI_RelayNo_31a= Tob_2(1,1)- Top_2(1,3);
CTI_RelayNo_32= Tob_2(1,5)- Top_2(1,4);
CTI_RelayNo_32a= Tob_2(1,14)- Top_2(1,4);
CTI_RelayNo_33= Tob_1(1,7)- Top_2(1,5);
CTI_RelayNo_33a= Tob_1(1,9)- Top_2(1,5);
CTI_RelayNo_34= Tob_2(1,3)- Top_2(1,6);
CTI_RelayNo_34a= Tob_2(1,14)- Top_2(1,6);
CTI_RelayNo_35= Tob_1(1,11)- Top_2(1,7);
CTI_RelayNo_35a= Tob_1(1,14)- Top_2(1,7);
CTI_RelayNo_36= Tob_2(1,10)- Top_2(1,8);
CTI_RelayNo_37= Tob_2(1,7)- Top_2(1,9);
CTI_RelayNo_38= Tob_2(1,12)- Top_2(1,10);
CTI_RelayNo_39= Tob_2(1,9)- Top_2(1,11);
CTI_RelayNo_40= Tob_2(1,13)- Top_2(1,12);
CTI_RelayNo_41= Tob_2(1,3)- Top_2(1,13);
CTI_RelayNo_41a= Tob_2(1,5)- Top_2(1,13);
CTI_RelayNo_42= Tob_2(1,11)- Top_2(1,14);

fprintf('The value of Coordination Time Of Interval Between Primary Relay No.1 and Backup Relay No.6=%f \n', CTI_RelayNo_1);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.2 and Backup Relay No.4=%f \n', CTI_RelayNo_2);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.2 and Backup Relay No.16=%f \n', CTI_RelayNo_2a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.3 and Backup Relay No.1=%f \n', CTI_RelayNo_3);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.3 and Backup Relay No.16=%f \n', CTI_RelayNo_3a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.4 and Backup Relay No.7=%f \n', CTI_RelayNo_4);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.4 and Backup Relay No.12=%f \n', CTI_RelayNo_4a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.4 and Backup Relay No.12=%f \n', CTI_RelayNo_4b);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.5 and Backup Relay No.14=%f \n', CTI_RelayNo_5);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.6 and Backup Relay No.5=%f \n', CTI_RelayNo_6);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.6 and Backup Relay No.13=%f \n', CTI_RelayNo_6a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.7 and Backup Relay No.7=%f \n', CTI_RelayNo_7);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.7 and Backup Relay No.9=%f \n', CTI_RelayNo_7a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.8 and Backup Relay No.10=%f \n', CTI_RelayNo_8);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.8 and Backup Relay No.11=%f \n', CTI_RelayNo_8a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.8 and Backup Relay No.12=%f \n', CTI_RelayNo_8b);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.9 and Backup Relay No.13=%f \n', CTI_RelayNo_9);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.9 and Backup Relay No.14=%f \n', CTI_RelayNo_9a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.10 and Backup Relay No.8=%f \n', CTI_RelayNo_10);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.11 and Backup Relay No.1=%f \n', CTI_RelayNo_11);

fprintf('The value of Coordination Time Of Interval Between Primary Relay No.11 and Backup Relay No.9=%f \n', CTI_RelayNo_11a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.11 and Backup Relay No.6=%f \n', CTI_RelayNo_11b);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.12 and Backup Relay No.1=%f \n', CTI_RelayNo_12);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.12 and Backup Relay No.7=%f \n', CTI_RelayNo_12a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.13 and Backup Relay No.2=%f \n', CTI_RelayNo_13);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.14 and Backup Relay No.3=%f \n', CTI_RelayNo_14);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.14 and Backup Relay No.4=%f \n', CTI_RelayNo_14a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.15 and Backup Relay No.5=%f \n', CTI_RelayNo_15);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.15 and Backup Relay No.14=%f \n', CTI_RelayNo_15a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.16 and Backup Relay No.5=%f \n', CTI_RelayNo_16);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.16 and Backup Relay No.13=%f \n', CTI_RelayNo_16a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.17 and Backup Relay No.7=%f \n', CTI_RelayNo_17);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.17 and Backup Relay No.9=%f \n', CTI_RelayNo_17a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.18 and Backup Relay No.10=%f \n', CTI_RelayNo_18);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.18 and Backup Relay No.11=%f \n', CTI_RelayNo_18a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.18 and Backup Relay No.12=%f \n', CTI_RelayNo_18b);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.19 and Backup Relay No.13=%f \n', CTI_RelayNo_19);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.19 and Backup Relay No.14=%f \n', CTI_RelayNo_19a);

fprintf('The value of Coordination Time Of Interval Between Primary Relay No.19 and Backup Relay No.14=%f \n', CTI_RelayNo_19b);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.20 and Backup Relay No.8=%f \n', CTI_RelayNo_20);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.20 and Backup Relay No.1=%f \n', CTI_RelayNo_20a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.20 and Backup Relay No.9=%f \n', CTI_RelayNo_20b);

fprintf('The value of Coordination Time Of Interval Between Primary Relay No.21 and Backup Relay No.6=%f \n', CTI_RelayNo_21);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.21 and Backup Relay No.1=%f \n', CTI_RelayNo_21a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.21 and Backup Relay No.7=%f \n', CTI_RelayNo_21b);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.22 and Backup Relay No.2=%f \n', CTI_RelayNo_22);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.22 and Backup Relay No.3=%f \n', CTI_RelayNo_22a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.23 and Backup Relay No.4=%f \n', CTI_RelayNo_23);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.23 and Backup Relay No.5=%f \n', CTI_RelayNo_23a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.24 and Backup Relay No.14=%f \n', CTI_RelayNo_24);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.24 and Backup Relay No.5=%f \n', CTI_RelayNo_24a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.25 and Backup Relay No.13=%f \n', CTI_RelayNo_25);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.25 and Backup Relay No.7=%f \n', CTI_RelayNo_25a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.26 and Backup Relay No.9=%f \n', CTI_RelayNo_26);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.26 and Backup Relay No.10=%f \n', CTI_RelayNo_26a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.27 and Backup Relay No.11=%f \n', CTI_RelayNo_27);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.27 and Backup Relay No.12=%f \n', CTI_RelayNo_27a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.28 and Backup Relay No.13=%f \n', CTI_RelayNo_28);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.28 and Backup Relay No.14=%f \n', CTI_RelayNo_28a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.29 and Backup Relay No.8=%f \n', CTI_RelayNo_29);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.29 and Backup Relay No.1=%f \n', CTI_RelayNo_29a);

fprintf('The value of Coordination Time Of Interval Between Primary Relay No.29 and Backup Relay No.9=%f \n', CTI_RelayNo_29b);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.30 and Backup Relay No.6=%f \n', CTI_RelayNo_30);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.30 and Backup Relay No.1=%f \n', CTI_RelayNo_30a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.31 and Backup Relay No.7=%f \n', CTI_RelayNo_31);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.31 and Backup Relay No.2=%f \n', CTI_RelayNo_31a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.32 and Backup Relay No.3=%f \n', CTI_RelayNo_32);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.32 and Backup Relay No.4=%f \n', CTI_RelayNo_32a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.33 and Backup Relay No.5=%f \n', CTI_RelayNo_33);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.33 and Backup Relay No.14=%f \n', CTI_RelayNo_33a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.34 and Backup Relay No.5=%f \n', CTI_RelayNo_34);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.34 and Backup Relay No.13=%f \n', CTI_RelayNo_34a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.35 and Backup Relay No.7=%f \n', CTI_RelayNo_35);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.35 and Backup Relay No.9=%f \n', CTI_RelayNo_35a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.36 and Backup Relay No.10=%f \n', CTI_RelayNo_36);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.37 and Backup Relay No.11=%f \n', CTI_RelayNo_37);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.38 and Backup Relay No.12=%f \n', CTI_RelayNo_38);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.39 and Backup Relay No.13=%f \n', CTI_RelayNo_39);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.40 and Backup Relay No.14=%f \n', CTI_RelayNo_40);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.41 and Backup Relay No.8=%f \n', CTI_RelayNo_41);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.41 and Backup Relay No.1=%f \n', CTI_RelayNo_41a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.42 and Backup Relay No.9=%f \n', CTI_RelayNo_42);
end
%%     Calculation For  IEEE 8 Bus System
if Benchmark_Function_ID==22
TMS1=L(1,1);
TMS2=L(1,2);
TMS3=L(1,3);
TMS4=L(1,4);
TMS5=L(1,5);
TMS6=L(1,6);
TMS7=L(1,7);
TMS8=L(1,8);
TMS9=L(1,9);
TMS10=L(1,10);
TMS11=L(1,11);
TMS12=L(1,12);
TMS13=L(1,13);
TMS14=L(1,14);
%% The Values Given For PTS (Pickup Tap setting) (Seeker Algorithm)
PTS1=L(1,15);
PTS2=L(1,16);
PTS3=L(1,17);
PTS4=L(1,18);
PTS5=L(1,19);
PTS6=L(1,20);
PTS7=L(1,21);
PTS8=L(1,22);
PTS9=L(1,23);
PTS10=L(1,24);
PTS11=L(1,25);
PTS12=L(1,26);
PTS13=L(1,27);
PTS14=L(1,28);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% TMS1=0.113;
% TMS2=0.26;
% TMS3=0.225;
% TMS4=0.16;
% TMS5=0.1;
% TMS6=0.173;
% TMS7=0.243;
% TMS8=0.17;
% TMS9=0.147;
% TMS10=0.176;
% TMS11=0.1870;
% TMS12=0.266;
% TMS13=0.114;
% TMS14=0.246;
% %% The Values Given For PTS (Pickup Tap setting) (Seeker Algorithm)
% PTS1=2.0;
% PTS2=2.5;
% PTS3=2.5;
% PTS4=2.5;
% PTS5=2.5;
% PTS6=2.5;
% PTS7=2.5;
% PTS8=2.5;
% PTS9=2.5;
% PTS10=2.5;
% PTS11=2.5;
% PTS12=2.5;
% PTS13=2.0;
% PTS14=2.5;
x=[TMS1,TMS2,TMS3,TMS4,TMS5,TMS6,TMS7,TMS8,TMS9,TMS10,TMS11,TMS12,TMS13,TMS14];
y=[PTS1,PTS2,PTS3,PTS4,PTS5,PTS6,PTS7,PTS8,PTS9,PTS10,PTS11,PTS12,PTS13,PTS14];
u=1;
v=14;
TMS=x;
PTS=y;
FaultCurrent_P=[3232,5924,3556,3783,2401,6109,5223,6093,2484,3883,3707,5899,2991,5199]; % Fault  Current For Primary Relay Values
FaultCurrent_B=[996,3556,2244,2401,1197,3232,1890,2991,1165,2484,2344,3707,987,1874]; % Fault  Current For Backup Relay Values
% PickupValue=[g,h,k,l,o,p];
CTRatio=[1200,1200,800,1200,1200,1200,800,1200,800,1200,1200,1200,1200,800];
CTRatio_Value=zeros(u,v); % Change CTRatio Matrix Transform 
for i=1:u
    for j=1:v
        CTRatio_Value(i,j)=CTRatio(u,v);
    end
end
% TMS=[a,b,c,d,e,f];
PickupTapSetting=((CTRatio/5)).*PTS;
% fprintf('The value of PickupTapSetting No.1=%f \n', PickupTapSetting(1,1)); 
% fprintf('The value of PickupTapSetting No.2=%f \n', PickupTapSetting(1,2));
% fprintf('The value of PickupTapSetting No.3=%f \n', PickupTapSetting(1,3));
% fprintf('The value of PickupTapSetting No.4=%f \n', PickupTapSetting(1,4));
% fprintf('The value of PickupTapSetting No.5=%f \n', PickupTapSetting(1,5));
% fprintf('The value of PickupTapSetting No.6=%f \n', PickupTapSetting(1,6));
%% Calculation for PSM (Plug Setting Multiplier)
PlugSettingMultiplier_P=((FaultCurrent_P)).*((PickupTapSetting).^(-1));
PlugSettingMultiplier_B=((FaultCurrent_B)).*((PickupTapSetting).^(-1));
% fprintf('The value of PlugSettingMultiplier No.1=%f \n', PlugSettingMultiplier(1,1)); 
% fprintf('The value of PlugSettingMultiplier No.2=%f \n', PlugSettingMultiplier(1,2));
% fprintf('The value of PlugSettingMultiplier No.3=%f \n', PlugSettingMultiplier(1,3));
% fprintf('The value of PlugSettingMultiplier No.4=%f \n', PlugSettingMultiplier(1,4));
% fprintf('The value of PlugSettingMultiplier No.5=%f \n', PlugSettingMultiplier(1,5));
% fprintf('The value of PlugSettingMultiplier No.6=%f \n', PlugSettingMultiplier(1,6));
%% Calculation 
PSM_Value_P=(((PlugSettingMultiplier_P).^0.02)-1);
PSM_Value_B=(((PlugSettingMultiplier_B).^0.02)-1);
TMS_Value=(0.14*TMS);
Top=((TMS_Value).*((PSM_Value_P).^(-1)));
Tob=((TMS_Value).*((PSM_Value_B).^(-1)));
% fprintf('The value of Operating Time No.1=%f \n', Top(1,1)); 
% fprintf('The value of Operating Time No.2=%f \n', Top(1,2));
% fprintf('The value of Operating Time No.3=%f \n', Top(1,3));
% fprintf('The value of Operating Time No.4=%f \n', Top(1,4));
% fprintf('The value of Operating Time No.5=%f \n', Top(1,5));
% fprintf('The value of Operating Time No.6=%f \n', Top(1,6));
Top_Primary=(Top(1,1)+(Top(1,2))+Top(1,3)+Top(1,4)+Top(1,5)+(Top(1,6))+(Top(1,7))+(Top(1,8))+Top(1,9)+Top(1,10)+Top(1,11)+(Top(1,12))+Top(1,13)+((Top(1,14))));
CTI_RelayNo_1= Tob(1,6)- Top(1,1);
CTI_RelayNo_2= Tob(1,1)- Top(1,2);
CTI_RelayNo_2a= Tob(1,7)- Top(1,2);
CTI_RelayNo_3= Tob(1,2)- Top(1,3);
CTI_RelayNo_4= Tob(1,3)- Top(1,4);
CTI_RelayNo_5= Tob(1,4)- Top(1,5);
CTI_RelayNo_6= Tob(1,5)- Top(1,6);
CTI_RelayNo_6a= Tob(1,14)- Top(1,6);
CTI_RelayNo_7= Tob(1,5)- Top(1,7);
CTI_RelayNo_7a= Tob(1,13)- Top(1,7);
CTI_RelayNo_8= Tob(1,7)- Top(1,8);
CTI_RelayNo_8a= Tob(1,9)- Top(1,8);
CTI_RelayNo_9= Tob(1,10)- Top(1,9);
CTI_RelayNo_10= Tob(1,11)- Top(1,10);
CTI_RelayNo_11= Tob(1,12)- Top(1,11);
CTI_RelayNo_12= Tob(1,13)- Top(1,12);
CTI_RelayNo_12a= Tob(1,14)- Top(1,12);
CTI_RelayNo_13= Tob(1,8)- Top(1,13);
CTI_RelayNo_14= Tob(1,1)- Top(1,14);
CTI_RelayNo_14a= Tob(1,9)- Top(1,14);
fprintf('The value of Total Operating Time of Primary Relays=%f \n', Top_Primary);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.1 and Backup Relay No.6=%f \n', CTI_RelayNo_1);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.2 and Backup Relay No.1=%f \n', CTI_RelayNo_2);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.2 and Backup Relay No.7=%f \n', CTI_RelayNo_2a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.3 and Backup Relay No.2=%f \n', CTI_RelayNo_3);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.4 and Backup Relay No.3=%f \n', CTI_RelayNo_4);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.5 and Backup Relay No.4=%f \n', CTI_RelayNo_5);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.6 and Backup Relay No.5=%f \n', CTI_RelayNo_6);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.6 and Backup Relay No.14=%f \n', CTI_RelayNo_6a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.7 and Backup Relay No.5=%f \n', CTI_RelayNo_7);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.7 and Backup Relay No.13=%f \n', CTI_RelayNo_7a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.8 and Backup Relay No.7=%f \n', CTI_RelayNo_8);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.8 and Backup Relay No.9=%f \n', CTI_RelayNo_8a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.9 and Backup Relay No.10=%f \n', CTI_RelayNo_9);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.10 and Backup Relay No.11=%f \n', CTI_RelayNo_10);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.11 and Backup Relay No.12=%f \n', CTI_RelayNo_11);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.12 and Backup Relay No.13=%f \n', CTI_RelayNo_12);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.12 and Backup Relay No.14=%f \n', CTI_RelayNo_12a);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.13 and Backup Relay No.8=%f \n', CTI_RelayNo_13);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.14 and Backup Relay No.1=%f \n', CTI_RelayNo_14);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.14 and Backup Relay No.9=%f \n', CTI_RelayNo_14a);
fit=Top_Primary;
end
%%% 
%%              Calculation For IEEE 3 Bus System  
if Benchmark_Function_ID==23
  TMS1=L(1,1);
TMS2=L(1,2);
TMS3=L(1,3);
TMS4=L(1,4);
TMS5=L(1,5);
TMS6=L(1,6);
%%%%%%%%%%%%%%%%%%%%%%
PTS1=L(1,7);
PTS2=L(1,8);
PTS3=L(1,9);
PTS4=L(1,10);
PTS5=L(1,11);
PTS6=L(1,12);
%%%%%%%%%%%%%%%%%
%% The Values Given For TMS (Time Multiplier setting) in (Simplex Method)
% a=0.1;
% b=0.1364;
% c=0.1;
% d=0.1;
% e=0.1298;
% f=0.1;
% %% The Values Given For PTS (Pickup Tap setting) in (Simplex Method)
% g=5;
% h=1.5;
% k=5;
% l=4;
% o=2;
% p=2.5;
% x=[a,b,c,d,e,f];
% y=[g,h,k,l,o,p];
n=1;
m=6;
TMS=[TMS1,TMS2,TMS3,TMS4,TMS5,TMS6]; % The TMS Values
PTS=[PTS1,PTS2,PTS3,PTS4,PTS5,PTS6]; % The PTS Values
FaultCurrent_P=[1978.90,1525.70,1683.90,1815.40,1499.66,1766.30]; % Fault  Current Values
FaultCurrent_B=[617.22,145.34,384,545,175,466.17]; % Fault Current for Backup Relay Values
CTRatio=[300,200,200,300,200,400]; % CTRatio Value
CTRatio_Value=zeros(n,m); % Change CTRatio Matrix Transform 
for i=1:n
    for j=1:m
        CTRatio_Value(i,j)=CTRatio(n,m);
    end
end

PickupTapSetting=((CTRatio/5)).*PTS; 
% fprintf('The value of PickupTapSetting No.1=%f \n', PickupTapSetting(1,1)); 
% fprintf('The value of PickupTapSetting No.2=%f \n', PickupTapSetting(1,2));
% fprintf('The value of PickupTapSetting No.3=%f \n', PickupTapSetting(1,3));
% fprintf('The value of PickupTapSetting No.4=%f \n', PickupTapSetting(1,4));
% fprintf('The value of PickupTapSetting No.5=%f \n', PickupTapSetting(1,5));
% fprintf('The value of PickupTapSetting No.6=%f \n', PickupTapSetting(1,6));
PlugSettingMultiplier_P=((FaultCurrent_P)).*((PickupTapSetting).^(-1));
PlugSettingMultiplier_B=((FaultCurrent_B)).*((PickupTapSetting).^(-1));
% fprintf('The value of PlugSettingMultiplier No.1=%f \n', PlugSettingMultiplier(1,1)); 
% fprintf('The value of PlugSettingMultiplier No.2=%f \n', PlugSettingMultiplier(1,2));
% fprintf('The value of PlugSettingMultiplier No.3=%f \n', PlugSettingMultiplier(1,3));
% fprintf('The value of PlugSettingMultiplier No.4=%f \n', PlugSettingMultiplier(1,4));
% fprintf('The value of PlugSettingMultiplier No.5=%f \n', PlugSettingMultiplier(1,5));
% fprintf('The value of PlugSettingMultiplier No.6=%f \n', PlugSettingMultiplier(1,6));
PSM_Value_P=(((PlugSettingMultiplier_P).^0.02)-1);
PSM_Value_B=(((PlugSettingMultiplier_B).^0.02)-1);
TMS_Value=(0.14*TMS);
Top=((TMS_Value).*((PSM_Value_P).^(-1)));
Tob=((TMS_Value).*((PSM_Value_B).^(-1)));
% fprintf('The value of Operating Time No.1=%f \n', Top(1,1)); 
% fprintf('The value of Operating Time No.2=%f \n', Top(1,2));
% fprintf('The value of Operating Time No.3=%f \n', Top(1,3));
% fprintf('The value of Operating Time No.4=%f \n', Top(1,4));
% fprintf('The value of Operating Time No.5=%f \n', Top(1,5));
% fprintf('The value of Operating Time No.6=%f \n', Top(1,6));
CTI_RelayNo_1= Tob(1,5)- Top(1,1);
CTI_RelayNo_2= Tob(1,4)- Top(1,2);
CTI_RelayNo_3= Tob(1,1)- Top(1,3);
CTI_RelayNo_4= Tob(1,6)- Top(1,4);
CTI_RelayNo_5= Tob(1,3)- Top(1,5);
CTI_RelayNo_6= Tob(1,2)- Top(1,6);
Top_Primary=Top(1,1)+Top(1,2)+Top(1,3)+Top(1,4)+Top(1,5)+Top(1,6);
fprintf('The value of Total Operating Time of Primary Relays=%f \n', Top_Primary);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.1 and Backup Relay No.5=%f \n', CTI_RelayNo_1);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.2 and Backup Relay No.4=%f \n', CTI_RelayNo_2);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.3 and Backup Relay No.1=%f \n', CTI_RelayNo_3);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.4 and Backup Relay No.6=%f \n', CTI_RelayNo_4);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.5 and Backup Relay No.3=%f \n', CTI_RelayNo_5);
fprintf('The value of Coordination Time Of Interval Between Primary Relay No.6 and Backup Relay No.2=%f \n', CTI_RelayNo_6);
fit=Top_Primary;
end
function y=Ufun(x,a,k,m)
y=k.*((x-a).^m).*(x>a)+k.*((-x-a).^m).*(x<(-a));
return